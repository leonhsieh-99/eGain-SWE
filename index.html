<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>eGain Chatbot Demo</title>
  <style>
    :root { --bg:#111; --panel:#1b1b1b; --bot:#2a2a2a; --user:#3a6cf4; --text:#eee; }
    * { box-sizing: border-box; }
    body { margin:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; background: var(--bg); color: var(--text); }
    .wrap { max-width: 760px; margin: 24px auto; padding: 16px; }
    h1 { font-size: 18px; margin: 0 0 12px; color:#cfcfcf; }
    .chat {
      background: var(--panel);
      border: 1px solid #2a2a2a;
      border-radius: 12px;
      padding: 12px;
      height: 70vh;
      overflow-y: auto;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    .msg {
      max-width: 75%;
      padding: 10px 12px;
      border-radius: 12px;
      line-height: 1.35;
      word-wrap: break-word;
      white-space: pre-wrap;
    }
    .bot   { align-self: flex-start; background: var(--bot); border: 1px solid #333; }
    .user  { align-self: flex-end;   background: var(--user); border: 1px solid #2b56c6; }
    .meta  { font-size: 12px; opacity: .7; margin: 8px 0 0; }
  </style>
</head>
<body>
  <div class="wrap">
    <h1>Wi-Fi Troubleshooting Chat</h1>
    <div id="chat" class="chat" aria-live="polite"></div>
    <div class="meta">Tip: run <code>python -m http.server 5500</code> and open <code>http://localhost:5500/</code>. The view refreshes every ~1.5s.</div>
  </div>

  <script>
    const chatEl = document.getElementById('chat');
    let lastText = '';

    function render(text) {
      if (text === lastText) return;
      lastText = text;

      const lines = text.split(/\r?\n/).filter(Boolean);
      chatEl.innerHTML = ''; // simple re-render

      for (const line of lines) {
        const isUser = line.startsWith('> ');
        const content = isUser ? line.slice(2) : line;

        const div = document.createElement('div');
        div.className = 'msg ' + (isUser ? 'user' : 'bot');
        div.textContent = content;
        chatEl.appendChild(div);
      }
      chatEl.scrollTop = chatEl.scrollHeight;
    }

    async function refresh() {
      try {
        const resp = await fetch('chatlog.txt?_=' + Date.now());
        if (!resp.ok) return;
        const text = await resp.text();
        render(text);
      } catch (e) {
        // ignore until server is up / file exists
      }
    }

    setInterval(refresh, 1500);
    refresh();
  </script>
</body>
</html>
